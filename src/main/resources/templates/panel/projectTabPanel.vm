
<section id="content" role="main">
<!-- Page Header must go inside #content before .aui-page-panel -->

    <header class="aui-page-header">
        <div class="aui-page-header-inner">
            <div class="aui-page-header-main">
                <h1>Support Assigner - Support Teams</h1>
            </div>
            <div>
                <button id="create-support-team" class="aui-button aui-button-subtle" disabled><span class="aui-icon aui-icon-small aui-iconfont-configure">Configure </span> New Team</button>
            </div>
        </div>
    </header>

<!-- Page Header must go inside #content before .aui-page-panel -->
    <div class="aui-page-panel">
        <div class="aui-page-panel-inner">
            <section class="aui-page-panel-content">
                
                
                    <div id="aui-message-bar"></div>
                    <div class="aui-tabs horizontal-tabs" id="tabs-example1">
                        <ul class="tabs-menu">

                            #set( $first=true )
                            #foreach ($team in $projectTeams)
                                #if($first) 
                                    #set($active="active-tab") 
                                    #set($first=false) 
                                #else
                                    #set($active="") 
                                #end
                                <li class="menu-item $active">
                                    <a href="#tabs-team-$team.ID"><strong>$team.name</strong></a>
                                </li>
                            #end
                        </ul>

                    #set( $first=true )
                    #foreach ($team in $projectTeams)
                        #if($first) 
                            #set($active="active-pane") 
                            #set($first=false) 
                        #else
                            #set($active="") 
                        #end
                        <div class="tabs-pane $active" id="tabs-team-$team.ID">
                            <h4>$team.name</h4>
                            <form id="form-team-$team.ID" class="aui" action="">
                                <fieldset>
                                    <table class="aui aui-table-sortable" width="90%">
                                        <thead>
                                            <tr>
                                                <th width="170px">       
                                                    <input class="checkbox" type="checkbox" name="selectAll" id="selectAll">
                                                    <label for="selectAll">Assignable?</label>
                                                </th>
                                                <th>Name</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                         #foreach ($assignment in $team.assignments)
                                            #set($person=$assignment.getUser())
                                            <tr>
                                                <td>
                                                    #if (${assignment.assignable})
                                                        #set($checked="CHECKED")
                                                    #else 
                                                        #set($checked="")
                                                    #end
                                                    <input type="checkbox" class="activatedUsers" name="activatedUsers" value="$person.getPrincipleName()" $checked >
                                                </td>
                                                <td>$person.displayName ($person.principleName)</td>
                                            </tr>
                                        #end
                                        </tbody>
                                    </table>
                                </fieldset>

                                <input type="hidden" name="teamId" id="teamId" value="$team.ID">
                                <button id="updateactives-$team.ID" class="aui-button aui-button-primary astupdate">Update Assigments</button>
                            </form>
                        </div>
                    #end

                </div>

            </section>
        </div>
    </div>
</section>


<!-- data used by soy templates -->
<input id="projectId" type="hidden" value="$project.id"/>

<script>
var rolesData = [
    #foreach ($role in $roles)
        {name: "$role.name"},
    #end
];
    
</script>

$webResourceManager.requireResource("com.edwardawebb.jira-assign-escalate-plugin:jira-assign-escalate-plugin-resources")
<script src="$req.contextPath/download/resources/com.edwardawebb.jira-assign-escalate:jira-assign-escalate-resources/jira-assign-escalate.js"></script>
<script src="$req.contextPath/download/resources/com.edwardawebb.jira-assign-escalate:jira-assign-escalate-resources/new-support-team-form.js"></script>
<script src="$req.contextPath/download/resources/com.edwardawebb.jira-assign-escalate:jira-assign-escalate-resources/new-support-team.js"></script>









   